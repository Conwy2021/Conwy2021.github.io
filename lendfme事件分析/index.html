<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Lendfme事件分析 - Conwy随笔</title><meta name="Description" content="begin 2022"><meta property="og:title" content="Lendfme事件分析" />
<meta property="og:description" content="事件相关信息 公链 以太坊链 黑客地址 0xa9bf70a420d364e923c74448d9d817d3f2a77822 攻击合约 0x538359785a8d5ab1a741a0ba94f26a800759d91d imBTC 地址 0x3212b29e33587a00fb1c83346f5dbfa69a458923 精度位 8 也就是为什么我们在交易记录中看到他的数字都是小数点后8位的原因 另外这个代币是ER" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://conwy2021.github.io/lendfme%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/" />
<meta property="og:image" content="https://conwy2021.github.io/logo.png"/>
<meta property="article:published_time" content="2022-12-28T21:38:14+08:00" />
<meta property="article:modified_time" content="2022-12-28T21:38:14+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://conwy2021.github.io/logo.png"/>

<meta name="twitter:title" content="Lendfme事件分析"/>
<meta name="twitter:description" content="事件相关信息 公链 以太坊链 黑客地址 0xa9bf70a420d364e923c74448d9d817d3f2a77822 攻击合约 0x538359785a8d5ab1a741a0ba94f26a800759d91d imBTC 地址 0x3212b29e33587a00fb1c83346f5dbfa69a458923 精度位 8 也就是为什么我们在交易记录中看到他的数字都是小数点后8位的原因 另外这个代币是ER"/>
<meta name="application-name" content="Conwy随笔">
<meta name="apple-mobile-web-app-title" content="Conwy随笔"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://conwy2021.github.io/lendfme%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/" /><link rel="prev" href="https://conwy2021.github.io/staking_algorithm/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Lendfme事件分析",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/conwy2021.github.io\/lendfme%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90\/"
        },"image": ["https:\/\/conwy2021.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "事件篇","wordcount":  2596 ,
        "url": "https:\/\/conwy2021.github.io\/lendfme%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90\/","datePublished": "2022-12-28T21:38:14+08:00","dateModified": "2022-12-28T21:38:14+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/conwy2021.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Conwy"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Conwy随笔">Conwy随笔</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Conwy随笔">Conwy随笔</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Lendfme事件分析</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Conwy</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"><i class="far fa-folder fa-fw"></i>区块链</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-12-28">2022-12-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2596 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 6 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#事件相关信息">事件相关信息</a></li>
    <li><a href="#攻击流程">攻击流程</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="事件相关信息">事件相关信息</h2>
<p>公链 以太坊链</p>
<p>黑客地址
0xa9bf70a420d364e923c74448d9d817d3f2a77822</p>
<p>攻击合约
0x538359785a8d5ab1a741a0ba94f26a800759d91d</p>
<p>imBTC 地址
0x3212b29e33587a00fb1c83346f5dbfa69a458923 精度位 8
也就是为什么我们在交易记录中看到他的数字都是小数点后8位的原因
另外这个代币是ERC777
<em>imBTC</em> (ERC-777) 是Tokenlon 在以太坊上发行的BTC 锚定币</p>
<p>借贷合约lendf.me
0x0eee3e3828a45f7601d5f54bf49bb01d1a9df5ea</p>
<p>interestRateModel合约的实现地址 利率算法合约
0x9a18c4d9587344f2b15686aa67ee7e5c4b00d549 （这里并没有用到）</p>
<p>预言机合约
0xb620707637c5b2cc49843a03d90e28d9abbda149 （这里并没有用到）
lendf.me 调用oracle函数返回价格用的</p>
<p>攻击者先给0x538359785a8d5ab1a741a0ba94f26a800759d91d 打了 21595 imBTC
交易hash 0x88fa4e8609baac44189a58faf7cb740cf35308957832ffd6656999229fea689f
(使用链必追查询，也可以进入合约地址的ERC-20 Token Txns 查到)</p>
<h2 id="攻击流程">攻击流程</h2>
<p>先上结论：</p>
<p>攻击者的思路是我提取我在借贷合约lendf.me（后续简称lendf.me）中的余额后，lendf.me中我的余额没有减少，却增加了。换句话说我提款后我在lendf.me的余额应该是减少的，实际却没有减少。注意是借贷合约lendf.me中的余额，用户在lendf.me中存的钱会保存在balance.principal中（结构体中的一个参数 我叫他本金）也就这个参数保存了用户在lendf.me合约中余额。</p>
<p>我们先分析他的第一笔攻击交易
0xe49304cd3edccf32069dcbbb5df7ac3b8678daad34d0ad1927aa725a8966d52a</p>
<p>地址：https://etherscan.io/tx/0xe49304cd3edccf32069dcbbb5df7ac3b8678daad34d0ad1927aa725a8966d52a</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228215914137.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228215914137.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228215914137.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228215914137.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228215914137.png"
        title="/image-20221228215914137" /></p>
<p>请注意，这是攻击的第一笔交易，攻击合约目前有21595个imBTC代币。攻击合约之前是没有在lendf.me存过款的，所以我在单看这笔交易时，其实没发现什么问题。</p>
<p>下面我们看下代码调用过程的，通过分析代码的调用，看看能发现什么新线索。
使用工具blocksec。</p>
<p>红框部分是这笔交易的第一次supply（存款操作）函数的调用</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220253003.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220253003.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220253003.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220253003.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228220253003.png"
        title="/image-20221228220253003" /></p>
<p>注意
EVENT中的amount=21,594, startingBalance=0, newBalance=21,594</p>
<p>说的意思是转入了21,594，刚开始本金是0，更新后的本金是21,594.也证实了这是攻击合约第一次在存款。</p>
<p>我们来看下这笔交易的第二次 supply</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220330992.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220330992.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220330992.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228220330992.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228220330992.png"
        title="/image-20221228220330992" /></p>
<p>EVENT中amount=1, startingBalance=0, newBalance=21,595
说的意思是转入了1，刚开始本金是0，更新后的本金是21956。
请注意我们在看ETH浏览器的交易中是，他是有withdraw（提款）的。我们看代码第二次调用时supply 中的imBTC.transferFrom 方法是与第一次不同的 其中多了第4层call，其中就含有Lendf.Me.withdraw方法的调用。
我们也在函数调用中看到攻击合约提取了21594个imBTC。这里发现两个问题，
1、	第二次transferFrom 中多了个withdraw方法。
2、	第二次supply更新后的本金是21955。提取21594 后本金本应该减少的。
先上答案。
1、	imBTC.transferFrom 方法存在重入
2、	重入导致攻击合约在lendf.me中余额变化异常，重点是攻击合约在lendf.me的余额记录。
第一个问题的解释，哪里重入了。
ImBTC是ERC777合约 这个合约会在转账时通知目标合约谁给你转钱了。也就是在通知这里有重入。（这个地方需要自己补充下相关知识，ERC777和ERC1820）
LendfMe.sol</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221026020.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221026020.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221026020.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221026020.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221026020.png"
        title="/image-20221228221026020" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221033373.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221033373.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221033373.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221033373.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221033373.png"
        title="/image-20221228221033373" /></p>
<p>imBTC.sol</p>
<p>​	<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221044504.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221044504.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221044504.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221044504.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221044504.png"
        title="/image-20221228221044504" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221048895.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221048895.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221048895.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221048895.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221048895.png"
        title="/image-20221228221048895" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221055457.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221055457.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221055457.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221055457.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221055457.png"
        title="/image-20221228221055457" /></p>
<p>攻击合约在tokenToSend中重入withdraw函数。
第二个问题的解释，重入导致了什么问题。
LendfMe.sol</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221119637.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221119637.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221119637.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221119637.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221119637.png"
        title="/image-20221228221119637" /></p>
<p>Balance.principal 保存的是用户在lendf.me金额，在第二次supply中，攻击合约同过重入提取了之前存入的21594后，重入函数中withdraw函数执行完成。
Withdraw函数中是有正确的更改用户在合约的余额的。
此时
balance.principal 其实是0 的。也是正确的数值。
重入函数中withdraw函数执行完成后，转账函数进而执行完成。（也就是交易详情为什么withdraw在第二次supply前面的原因）
继续进行1590行后的操作，localResults.userSupplyUpdated存的是21594+1。再更新为用户的余额就是21595。也就是supply的余额覆盖了正确的数值。
正常用户的余额应该是1。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221158953.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221158953.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221158953.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221158953.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221158953.png"
        title="/image-20221228221158953" /></p>
<p>localResults.userSupplyUpdated存的是21594+1的由来，是第一次supply的21594，加上第二次supply中的1。
补充说下：calculateBalance函数是计算你存入期间本金+利息。我们这一笔交易没有利息。
以上就是这次攻击的分析，总结下：</p>
<p>重点就是用户第一次存入了21594，合约中本金是21594.第二次存入1，提取21594，合约中本金却是21595。
下面按数据变化分析整个流程：
第一笔
攻击交易：0xe49304cd3edccf32069dcbbb5df7ac3b8678daad34d0ad1927aa725a8966d52a
时间 Apr-19-2020 12:58:43 AM +UTC
交易过程</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 21595
Lendf.Me                                      imBTC 29134710218</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=21594)（第一次正常访问）
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 21594</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 1
Lendf.Me                                      imBTC 29134731812</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=1)（第二次supply 重入withdraw）
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 1</p>
<p>**正常交易的账号余额应为
账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 0
Lendf.Me                                      imBTC 29134731813</p>
<p>withdraw
Lendf.Me  -&gt; 0x538359785a8d5ab1a741a0ba94f26a800759d91d imBTC 21594</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 21594
Lendf.Me                                      imBTC 29134710219</p>
<p>Lendf.Me合约用户的余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 21595</p>
<p>重点就是这个Lendf.Me合约用户的余额。这个数据看第二笔交易查到的。</p>
<p>这边附上 查看攻击合约的代码。使用工具https://library.dedaub.com/decompile</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221404349.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221404349.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221404349.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221404349.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221404349.png"
        title="/image-20221228221404349" /></p>
<p>_tokensToSend = 1; 表示第一次正常supply
_tokensToSend = 0; 表示第二次重入supply
重入代码为</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221420382.png"
        data-srcset="lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221420382.png, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221420382.png 1.5x, lendfme%e4%ba%8b%e4%bb%b6%e5%88%86%e6%9e%90.assets/image-20221228221420382.png 2x"
        data-sizes="auto"
        alt="lendfme事件分析.assets/image-20221228221420382.png"
        title="/image-20221228221420382" /></p>
<p>附上第二，三次交易数据交易流程
第二笔
攻击交易：0xae7d664bdfcc54220df4f18d339005c6faf6e62c9ca79c56387bc0389274363b
时间 Apr-19-2020 12:58:55 AM +UTC</p>
<p>交易过程</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 21594
Lendf.Me                                      imBTC 29134710219</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=21593)
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 21593</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 1
Lendf.Me                                      imBTC 29134731812</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=1)
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 1</p>
<p>**正常交易的账号余额应为
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 0
Lendf.Me                                      imBTC 29134731813</p>
<p>withdraw
Lendf.Me  -&gt; 0x538359785a8d5ab1a741a0ba94f26a800759d91d imBTC 43188</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 43188
Lendf.Me                                      imBTC 29134688625</p>
<p>Lendf.Me合约用户余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 43189
第三笔
攻击交易：0xa0e7c8e933be65854bee69df3816a07be37e108c43bbe7c7f2c3da01b79ad95e
时间 Apr-19-2020 12:59:19 AM +UTC</p>
<p>交易过程</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 43188
Lendf.Me                                      imBTC 29134688625</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=43187)
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 43187</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 1
Lendf.Me                                      imBTC 29134731812</p>
<p>交易动作 Lendf.Me.supply(asset=imBTC, amount=1)
转账交易
0x538359785a8d5ab1a741a0ba94f26a800759d91d -&gt; Lendf.Me   imBTC 1</p>
<p>**正常交易的账号余额应为
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 0
Lendf.Me                                      imBTC 29134731813</p>
<p>withdraw
Lendf.Me  -&gt; 0x538359785a8d5ab1a741a0ba94f26a800759d91d imBTC 86376</p>
<p>账号余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 86376
Lendf.Me                                      imBTC 29134645437</p>
<p>Lendf.Me合约用户余额
0x538359785a8d5ab1a741a0ba94f26a800759d91d    imBTC 86377</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-12-28</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/lendfme%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/%E4%BA%8B%E4%BB%B6%E7%AF%87/">事件篇</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/staking_algorithm/" class="prev" rel="prev" title=" uniswap v2 抵押挖矿 算法分析"><i class="fas fa-angle-left fa-fw"></i> uniswap v2 抵押挖矿 算法分析</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
